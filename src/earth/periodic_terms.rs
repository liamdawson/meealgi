use num::rational::BigRational;

/// A row from the Earth's Periodic Terms table (from the
/// NREL SPA document)
#[derive(Debug, Clone)]
pub struct EarthPeriodicTableRow {
    pub term : &'static str,
    pub a : BigRational,
    pub b : BigRational,
    pub c : BigRational
}

macro_rules! periodic_term_table {
    ( $($name : expr, $( $vals : expr ),+);* ) => {
        &[
            $($(
                EarthPeriodicTableRow {
                    term: $name,
                    a: BigRational::from_float($vals[0]).unwrap(),
                    b: BigRational::from_float($vals[1]).unwrap(),
                    c: BigRational::from_float($vals[2]).unwrap()
                }
            ),*),*
        ]
    }
}

/// A collection of Earth's Periodic Terms as per the NREL
/// SPA document (A.4.2)
pub const EARTH_PERIODIC_TERMS : &[EarthPeriodicTableRow] = periodic_term_table!(
    "L0",
        [    175347046_f64,          0_f64,           0_f64],
        [      3341656_f64,  4.6692568_f64,  6283.07585_f64],
        [        34894_f64,     4.6261_f64,  12566.1517_f64],
        [         3497_f64,     2.7441_f64,   5753.3849_f64],
        [         3418_f64,     2.8289_f64,      3.5231_f64],
        [         3136_f64,     3.6277_f64,  77713.7715_f64],
        [         2676_f64,     4.4181_f64,   7860.4194_f64],
        [         2343_f64,     6.1352_f64,   3930.2097_f64],
        [         1324_f64,     0.7425_f64,  11506.7698_f64],
        [         1273_f64,     2.0371_f64,     529.691_f64],
        [         1199_f64,     1.1096_f64,   1577.3435_f64],
        [          990_f64,      5.233_f64,    5884.927_f64],
        [          902_f64,      2.045_f64,      26.298_f64],
        [          857_f64,      3.508_f64,     398.149_f64],
        [          780_f64,      1.179_f64,    5223.694_f64],
        [          753_f64,      2.533_f64,    5507.553_f64],
        [          505_f64,      4.583_f64,   18849.228_f64],
        [          492_f64,      4.205_f64,     775.523_f64],
        [          357_f64,       2.92_f64,       0.067_f64],
        [          317_f64,      5.849_f64,   11790.629_f64],
        [          284_f64,      1.899_f64,     796.298_f64],
        [          271_f64,      0.315_f64,   10977.079_f64],
        [          243_f64,      0.345_f64,    5486.778_f64],
        [          206_f64,      4.806_f64,    2544.314_f64],
        [          205_f64,      1.869_f64,    5573.143_f64],
        [          202_f64,      2.458_f64,    6069.777_f64],
        [          156_f64,      0.833_f64,     213.299_f64],
        [          132_f64,      3.411_f64,    2942.463_f64],
        [          126_f64,      1.083_f64,      20.775_f64],
        [          115_f64,      0.645_f64,        0.98_f64],
        [          103_f64,      0.636_f64,    4694.003_f64],
        [          102_f64,      0.976_f64,   15720.839_f64],
        [          102_f64,      4.267_f64,       7.114_f64],
        [           99_f64,       6.21_f64,     2146.17_f64],
        [           98_f64,       0.68_f64,      155.42_f64],
        [           86_f64,       5.98_f64,   161000.69_f64],
        [           85_f64,        1.3_f64,     6275.96_f64],
        [           85_f64,       3.67_f64,     71430.7_f64],
        [           80_f64,       1.81_f64,    17260.15_f64],
        [           79_f64,       3.04_f64,    12036.46_f64],
        [           75_f64,       1.76_f64,     5088.63_f64],
        [           74_f64,        3.5_f64,     3154.69_f64],
        [           74_f64,       4.68_f64,      801.82_f64],
        [           70_f64,       0.83_f64,     9437.76_f64],
        [           62_f64,       3.98_f64,     8827.39_f64],
        [           61_f64,       1.82_f64,      7084.9_f64],
        [           57_f64,       2.78_f64,      6286.6_f64],
        [           56_f64,       4.39_f64,     14143.5_f64],
        [           56_f64,       3.47_f64,     6279.55_f64],
        [           52_f64,       0.19_f64,    12139.55_f64],
        [           52_f64,       1.33_f64,     1748.02_f64],
        [           51_f64,       0.28_f64,     5856.48_f64],
        [           49_f64,       0.49_f64,     1194.45_f64],
        [           41_f64,       5.37_f64,     8429.24_f64],
        [           41_f64,        2.4_f64,    19651.05_f64],
        [           39_f64,       6.17_f64,    10447.39_f64],
        [           37_f64,       6.04_f64,    10213.29_f64],
        [           37_f64,       2.57_f64,     1059.38_f64],
        [           36_f64,       1.71_f64,     2352.87_f64],
        [           36_f64,       1.78_f64,     6812.77_f64],
        [           33_f64,       0.59_f64,    17789.85_f64],
        [           30_f64,       0.44_f64,    83996.85_f64],
        [           30_f64,       2.74_f64,     1349.87_f64],
        [           25_f64,       3.16_f64,     4690.48_f64];
    "L1",
        [ 628331966747_f64,          0_f64,           0_f64],
        [       206059_f64,   2.678235_f64,  6283.07585_f64],
        [         4303_f64,     2.6351_f64,  12566.1517_f64],
        [          425_f64,       1.59_f64,       3.523_f64],
        [          119_f64,      5.796_f64,      26.298_f64],
        [          109_f64,      2.966_f64,    1577.344_f64],
        [           93_f64,       2.59_f64,    18849.23_f64],
        [           72_f64,       1.14_f64,      529.69_f64],
        [           68_f64,       1.87_f64,      398.15_f64],
        [           67_f64,       4.41_f64,     5507.55_f64],
        [           59_f64,       2.89_f64,     5223.69_f64],
        [           56_f64,       2.17_f64,      155.42_f64],
        [           45_f64,        0.4_f64,       796.3_f64],
        [           36_f64,       0.47_f64,      775.52_f64],
        [           29_f64,       2.65_f64,        7.11_f64],
        [           21_f64,       5.34_f64,        0.98_f64],
        [           19_f64,       1.85_f64,     5486.78_f64],
        [           19_f64,       4.97_f64,       213.3_f64],
        [           17_f64,       2.99_f64,     6275.96_f64],
        [           16_f64,       0.03_f64,     2544.31_f64],
        [           16_f64,       1.43_f64,     2146.17_f64],
        [           15_f64,       1.21_f64,    10977.08_f64],
        [           12_f64,       2.83_f64,     1748.02_f64],
        [           12_f64,       3.26_f64,     5088.63_f64],
        [           12_f64,       5.27_f64,     1194.45_f64],
        [           12_f64,       2.08_f64,        4694_f64],
        [           11_f64,       0.77_f64,      553.57_f64],
        [           10_f64,        1.3_f64,      6286.6_f64],
        [           10_f64,       4.24_f64,     1349.87_f64],
        [            9_f64,        2.7_f64,      242.73_f64],
        [            9_f64,       5.64_f64,      951.72_f64],
        [            8_f64,        5.3_f64,     2352.87_f64],
        [            6_f64,       2.65_f64,     9437.76_f64],
        [            6_f64,       4.67_f64,     4690.48_f64];
    "L2",
        [        52919_f64,          0_f64,           0_f64],
        [         8720_f64,     1.0721_f64,   6283.0758_f64],
        [          309_f64,      0.867_f64,   12566.152_f64],
        [           27_f64,       0.05_f64,        3.52_f64],
        [           16_f64,       5.19_f64,        26.3_f64],
        [           16_f64,       3.68_f64,      155.42_f64],
        [           10_f64,       0.76_f64,    18849.23_f64],
        [            9_f64,       2.06_f64,    77713.77_f64],
        [            7_f64,       0.83_f64,      775.52_f64],
        [            5_f64,       4.66_f64,     1577.34_f64],
        [            4_f64,       1.03_f64,        7.11_f64],
        [            4_f64,       3.44_f64,     5573.14_f64],
        [            3_f64,       5.14_f64,       796.3_f64],
        [            3_f64,       6.05_f64,     5507.55_f64],
        [            3_f64,       1.19_f64,      242.73_f64],
        [            3_f64,       6.12_f64,      529.69_f64],
        [            3_f64,       0.31_f64,      398.15_f64],
        [            3_f64,       2.28_f64,      553.57_f64],
        [            2_f64,       4.38_f64,     5223.69_f64],
        [            2_f64,       3.75_f64,        0.98_f64];
    "L3",
        [          289_f64,      5.844_f64,    6283.076_f64],
        [           35_f64,          0_f64,           0_f64],
        [           17_f64,       5.49_f64,    12566.15_f64],
        [            3_f64,        5.2_f64,      155.42_f64],
        [            1_f64,       4.72_f64,        3.52_f64],
        [            1_f64,        5.3_f64,    18849.23_f64],
        [            1_f64,       5.97_f64,      242.73_f64];
    "L4",
        [          114_f64,      3.142_f64,           0_f64],
        [            8_f64,       4.13_f64,     6283.08_f64],
        [            1_f64,       3.84_f64,    12566.15_f64];
    "L5",
        [            1_f64,       3.14_f64,           0_f64];
    "B0",
        [          280_f64,      3.199_f64,   84334.662_f64],
        [          102_f64,      5.422_f64,    5507.553_f64],
        [           80_f64,       3.88_f64,     5223.69_f64],
        [           44_f64,        3.7_f64,     2352.87_f64],
        [           32_f64,          4_f64,     1577.34_f64];
    "B1",
        [            9_f64,        3.9_f64,     5507.55_f64],
        [            6_f64,       1.73_f64,     5223.69_f64];
    "R0",
        [    100013989_f64,          0_f64,           0_f64],
        [      1670700_f64,  3.0984635_f64,  6283.07585_f64],
        [        13956_f64,    3.05525_f64,  12566.1517_f64],
        [         3084_f64,     5.1985_f64,  77713.7715_f64],
        [         1628_f64,     1.1739_f64,   5753.3849_f64],
        [         1576_f64,     2.8469_f64,   7860.4194_f64],
        [          925_f64,      5.453_f64,    11506.77_f64],
        [          542_f64,      4.564_f64,     3930.21_f64],
        [          472_f64,      3.661_f64,    5884.927_f64],
        [          346_f64,      0.964_f64,    5507.553_f64],
        [          329_f64,        5.9_f64,    5223.694_f64],
        [          307_f64,      0.299_f64,    5573.143_f64],
        [          243_f64,      4.273_f64,   11790.629_f64],
        [          212_f64,      5.847_f64,    1577.344_f64],
        [          186_f64,      5.022_f64,   10977.079_f64],
        [          175_f64,      3.012_f64,   18849.228_f64],
        [          110_f64,      5.055_f64,    5486.778_f64],
        [           98_f64,       0.89_f64,     6069.78_f64],
        [           86_f64,       5.69_f64,    15720.84_f64],
        [           86_f64,       1.27_f64,   161000.69_f64],
        [           65_f64,       0.27_f64,    17260.15_f64],
        [           63_f64,       0.92_f64,      529.69_f64],
        [           57_f64,       2.01_f64,    83996.85_f64],
        [           56_f64,       5.24_f64,     71430.7_f64],
        [           49_f64,       3.25_f64,     2544.31_f64],
        [           47_f64,       2.58_f64,      775.52_f64],
        [           45_f64,       5.54_f64,     9437.76_f64],
        [           43_f64,       6.01_f64,     6275.96_f64],
        [           39_f64,       5.36_f64,        4694_f64],
        [           38_f64,       2.39_f64,     8827.39_f64],
        [           37_f64,       0.83_f64,    19651.05_f64],
        [           37_f64,        4.9_f64,    12139.55_f64],
        [           36_f64,       1.67_f64,    12036.46_f64],
        [           35_f64,       1.84_f64,     2942.46_f64],
        [           33_f64,       0.24_f64,      7084.9_f64],
        [           32_f64,       0.18_f64,     5088.63_f64],
        [           32_f64,       1.78_f64,      398.15_f64],
        [           28_f64,       1.21_f64,      6286.6_f64],
        [           28_f64,        1.9_f64,     6279.55_f64],
        [           26_f64,       4.59_f64,    10447.39_f64];
    "R1",
        [       103019_f64,    1.10749_f64,  6283.07585_f64],
        [         1721_f64,     1.0644_f64,  12566.1517_f64],
        [          702_f64,      3.142_f64,           0_f64],
        [           32_f64,       1.02_f64,    18849.23_f64],
        [           31_f64,       2.84_f64,     5507.55_f64],
        [           25_f64,       1.32_f64,     5223.69_f64],
        [           18_f64,       1.42_f64,     1577.34_f64],
        [           10_f64,       5.91_f64,    10977.08_f64],
        [            9_f64,       1.42_f64,     6275.96_f64],
        [            9_f64,       0.27_f64,     5486.78_f64];
    "R2",
        [         4359_f64,     5.7846_f64,   6283.0758_f64],
        [          124_f64,      5.579_f64,   12566.152_f64],
        [           12_f64,       3.14_f64,           0_f64],
        [            9_f64,       3.63_f64,    77713.77_f64],
        [            6_f64,       1.87_f64,     5573.14_f64],
        [            3_f64,       5.47_f64,    18849.23_f64];
    "R3",
        [          145_f64,      4.273_f64,    6283.076_f64],
        [            7_f64,       3.92_f64,    12566.15_f64];
    "R4",
        [            4_f64,       2.56_f64,     6283.08_f64]);
